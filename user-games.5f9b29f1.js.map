{"mappings":"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","sources":["src/scripts/pages-scripts/user-games.js","src/templates/user-games.hbs"],"sourcesContent":["import 'lazysizes';\nimport 'lazysizes/plugins/parent-fit/ls.parent-fit';\nimport { DataBase } from '../../modules/database';\nimport { loadFromLS, redirect } from '../helpers';\nimport gamesTemplate from '../../templates/user-games.hbs';\n\nconst refs = {\n  addGameBtn: document.querySelector('.js-add-game'),\n  backdrop: document.querySelector('.backdrop'),\n  createForm: document.querySelector('.js-create-form'),\n  errorPage: document.querySelector('.js-error-page'),\n  gamesListElem: document.querySelector('.js-cart-list')\n};\n\n// =========== MODAL =================================\nfunction initModal() {\n  refs.addGameBtn.addEventListener('click', () => {\n    openModal();\n  });\n  function openModal() {\n    document.body.classList.add('show');\n    document.addEventListener('keydown', onClose);\n  }\n\n  function onClose(e) {\n    if (e.key == 'Escape') {\n      closeModal();\n    }\n  }\n  function closeModal() {\n    document.body.classList.remove('show');\n    document.removeEventListener('keydown', onClose);\n  }\n  refs.backdrop.addEventListener('click', e => {\n    if (e.target !== e.currentTarget) return;\n    closeModal();\n  });\n  function closeModal() {\n    document.body.classList.remove('show');\n  }\n}\ninitModal();\n// ====================================================\n\nrefs.createForm.addEventListener('submit',async e => {\n  e.preventDefault();\n\n  const formData = new FormData(e.target);\n  const game = {};\n\n  for (let [key, value] of formData.entries()) {\n    game[key] = value;\n  }\n\n  const gameId = await DataBase.createGame();\n  DataBase.addGameForUser(gameId);\n  renderGames();\n  document.body.classList.remove('show');\n});\n\nrenderGames();\nasync function renderGames(){\n  const userGames = loadFromLS('user')?.games;\n  const games = await DataBase.getGame(...userGames);\n  if(games.length === 0){\n    refs.gamesListElem.innerHTML = '';\n    refs.errorPage.classList.remove('hide')\n    return;\n  }\n  refs.errorPage.classList.add('hide');\n\n  refs.gamesListElem.innerHTML = games.map(gamesTemplate).join('');;\n}\n\nrefs.gamesListElem.addEventListener('click', (e)=>{\n  if(e.target === e.currentTarget) return;\n  const liElem = e.target.closest('li');\n  const gameId = liElem.dataset.id;\n\n  if(e.target.nodeName === \"BUTTON\")deleteGame(gameId);\n  else{\n    redirect('game-info.html', `?id=${gameId}`);\n  }\n  \n})\n\nfunction deleteGame(gameId){\n  DataBase.deleteGame(gameId);\n  DataBase.removeGameFromUser(gameId);\n  renderGames();\n}","<li data-id=\"{{id}}\">\n    <div class=\"game-img\"><img alt=\"image\" class=\"lazyload\" data-src=\"{{images.[0]}}\"\n            src=\"https://wallpaperaccess.com/full/1457170.jpg\"></div>\n    <div class=\"cart-info\">\n        <span>{{name}}</span>\n        <span>Author: {{author}}</span>\n        <span>OS: {{os}}</span>\n        <span>Price: {{price}} UAH</span>\n        <button class=\"btn\">Delete</button>\n    </div>\n</li>"],"names":["parcelRequire","$b0e0e85bb1cb4fbe$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","stack1","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","lambda","useData","$ee0eeaebb866f09d$var$refs","addGameBtn","document","querySelector","backdrop","createForm","errorPage","gamesListElem","async","$ee0eeaebb866f09d$var$renderGames","userGames","$fDHq9","loadFromLS","games","$ivJx2","DataBase","getGame","length","innerHTML","classList","remove","add","map","join","onClose","e","key","closeModal","body","removeEventListener","addEventListener","target","currentTarget","$ee0eeaebb866f09d$var$initModal","preventDefault","formData","FormData","game","value","entries","gameId","createGame","addGameForUser","closest","dataset","id","nodeName","deleteGame","removeGameFromUser","$ee0eeaebb866f09d$var$deleteGame","redirect"],"version":3,"file":"user-games.5f9b29f1.js.map"}