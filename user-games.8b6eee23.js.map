{"mappings":"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","sources":["src/scripts/pages-scripts/user-games.js","src/templates/user-games.hbs"],"sourcesContent":["import 'lazysizes';\nimport 'lazysizes/plugins/parent-fit/ls.parent-fit';\nimport { DataBase } from '../../modules/database';\nimport { loadFromLS, redirect } from '../helpers';\nimport gamesTemplate from '../../templates/user-games.hbs';\n\nconst refs = {\n  addGameBtn: document.querySelector('.js-add-game'),\n  backdrop: document.querySelector('.backdrop'),\n  createForm: document.querySelector('.js-create-form'),\n  errorPage: document.querySelector('.js-error-page'),\n  gamesListElem: document.querySelector('.js-cart-list'),\n  addBtn: document.querySelector('.js-btn-add'),\n};\n\n// =========== MODAL =================================\nfunction initModal() {\n  refs.addGameBtn.addEventListener('click', openModal);\n  refs.addBtn.addEventListener('click', openModal);\n\n  function openModal() {\n    document.body.classList.add('show');\n    document.addEventListener('keydown', onClose);\n  }\n\n  function onClose(e) {\n    if (e.key == 'Escape') {\n      closeModal();\n    }\n  }\n  function closeModal() {\n    document.body.classList.remove('show');\n    document.removeEventListener('keydown', onClose);\n  }\n  refs.backdrop.addEventListener('click', e => {\n    if (e.target !== e.currentTarget) return;\n    closeModal();\n  });\n  function closeModal() {\n    document.body.classList.remove('show');\n  }\n}\ninitModal();\n// ====================================================\n\nrefs.createForm.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formData = new FormData(e.target);\n  const game = {};\n\n  for (let [key, value] of formData.entries()) {\n    game[key] = value;\n  }\n\n  const gameId = await DataBase.createGame();\n  DataBase.addGameForUser(gameId);\n  renderGames();\n  document.body.classList.remove('show');\n  e.target.reset();\n});\n\nrenderGames();\nasync function renderGames() {\n  const userGames = loadFromLS('user')?.games || [];\n  const games = await DataBase.getGame(...userGames);\n  if (games.length === 0) {\n    refs.gamesListElem.innerHTML = '';\n    refs.errorPage.classList.remove('hide');\n    refs.addBtn.classList.add('hide');\n    return;\n  }\n  refs.addBtn.classList.remove('hide');\n  refs.errorPage.classList.add('hide');\n\n  refs.gamesListElem.innerHTML = games.map(gamesTemplate).join('');\n}\n\nrefs.gamesListElem.addEventListener('click', e => {\n  if (e.target === e.currentTarget) return;\n  const liElem = e.target.closest('li');\n  const gameId = liElem.dataset.id;\n\n  if (e.target.nodeName === 'BUTTON') deleteGame(gameId);\n  else {\n    redirect('game-info.html', `?id=${gameId}`);\n  }\n});\n\nfunction deleteGame(gameId) {\n  DataBase.deleteGame(gameId);\n  DataBase.removeGameFromUser(gameId);\n  renderGames();\n}\n","<li data-id=\"{{id}}\">\n    <div class=\"game-img\"><img alt=\"image\" class=\"lazyload\" data-src=\"{{images.[0]}}\"\n            src=\"https://wallpaperaccess.com/full/1457170.jpg\"></div>\n    <div class=\"cart-info\">\n        <span>{{name}}</span>\n        <span>Author: {{author}}</span>\n        <span>OS: {{os}}</span>\n        <span>Price: {{price}} USD</span>\n        <button class=\"btn\">Delete</button>\n    </div>\n</li>"],"names":["parcelRequire","$b0e0e85bb1cb4fbe$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","stack1","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","lambda","useData","$ee0eeaebb866f09d$var$refs","addGameBtn","document","querySelector","backdrop","createForm","errorPage","gamesListElem","addBtn","async","$ee0eeaebb866f09d$var$renderGames","userGames","$fDHq9","loadFromLS","games","$ivJx2","DataBase","getGame","length","innerHTML","classList","remove","add","map","join","openModal","body","addEventListener","onClose","e","key","closeModal","removeEventListener","target","currentTarget","$ee0eeaebb866f09d$var$initModal","preventDefault","formData","FormData","game","value","entries","gameId","createGame","addGameForUser","reset","closest","dataset","id","nodeName","deleteGame","removeGameFromUser","$ee0eeaebb866f09d$var$deleteGame","redirect"],"version":3,"file":"user-games.8b6eee23.js.map"}